<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Game Card Factory ‚Äî Law 5 Referee</title>

  <link rel="icon" href="images/favicon.svg" type="image/svg+xml" />
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="css/fast-card-factory.css">
  <link rel="stylesheet" href="css/mapping-ui.css">
  <!-- PDF + FileSaver + JSZip -->
  <script src="https://unpkg.com/pdf-lib/dist/pdf-lib.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>

	<link rel="stylesheet" href="../shared/shared-factory-ui.css">
</head>

<body class="admin-page">

	<header>
	  <h1>Law Five Referee - Game Card Factory</h1>
	  <nav>
		<a href="/index.html">Home</a>
		<a href="/penalty-shootout.html">Penalty Shoot-out</a>
		<a href="/quicklook-today.html">QuickLook Today</a>
		<a href="/apps/game-card-factory/index.html">Game Card Factory</a>
		<a href="/apps/lineup-card-factory/index.html">Lineup Card Factory</a>
		<a href="/downloads.html">Downloads</a>
		<a href="/contact.html">Contact</a>
		<a href="/privacy.html">Privacy</a>
	  </nav>
	</header>

	<div class="container">

	<h1>Game Card Factory</h1>
	<p class="intro-blurb">
	<strong>Paste a schedule, preview game cards, and generate match report PDFs.</strong>
	</p>

	<!-- ========================= -->
	<!-- Parser Help (Static) -->
	<!-- ========================= -->
	<div class="parser-help-wrapper">
	<div class="parser-help-body" id="parserHelpBody">
	  <h4>Available Extractors</h4>
	  <div class="parser-help-item"><strong>Text Advanced</strong><br>12-line AYSO block format.</div>
	  <div class="parser-help-item"><strong>Arbiter GameView</strong><br>Paste full ArbiterSports ‚ÄúGame Details‚Äù.</div>
	  <div class="parser-help-item"><strong>Arbiter Email</strong><br>Paste entire ArbiterSports email notification.</div>
	  <div class="parser-help-item"><strong>Google Sheets / CSV</strong><br>One row per game.</div>
	  <div class="parser-help-item"><strong>Compact</strong><br>Single-line formats.</div>
	  <div class="parser-help-item"><strong>AYSO Schedule</strong><br>Region spreadsheet formats.</div>
	</div>
	</div>

	<!-- ============================================================ -->
<!-- Collapsible Sections -->
<!-- ============================================================ -->

	<!-- ============================================================ -->
	<!-- 1. Import & Extract Schedule -->
	<!-- ============================================================ -->

	<section class="collapsible-panel" id="section-schedule-import">

  <button type="button" class="collapsible-header">
    <span class="collapsible-icon">‚àí</span>
    <span class="collapsible-title">
      1. Import & Extract Schedule
    </span>
  </button>

  <div class="collapsible-body">

	<!-- ===============================
			 Parser Carousel
	================================ -->
	<div class="parser-carousel">

		<button id="prevParser" class="carousel-arrow left">
			‚óÄ
		</button>

		<div class="parser-info">
			<div id="parserName" class="parser-name">
				(No parsers available)
			</div>
			<div id="parserDescription" class="parser-description"></div>
		</div>

		<button id="nextParser" class="carousel-arrow right">
			‚ñ∂
		</button>

	</div>
    <!-- ===============================
         Mapping Action Buttons
         (Only visible for custom mappers)
    ================================ -->
	<div id="mappingActionBar" class="mapping-action-bar" style="display:none;">
      <button id="editMappingBtn" class="btn small">
        ‚úèÔ∏è Edit Mapping
      </button>

      <button id="deleteMappingProfileBtn" class="btn small danger">
        üóë Delete Mapping
      </button>

    </div>


    <!-- ===============================
         Raw Schedule Input
    ================================ -->
    <label for="rawInput" class="section-label">
      Paste Schedule Text:
    </label>

    <textarea
      id="rawInput"
      class="import-textarea"
      placeholder="Paste schedule text here‚Ä¶"
      data-parser-key="">
    </textarea>


    <!-- ===============================
         Extract Button + Status
    ================================ -->
    <div class="button-group">

      <button id="parseBtn" class="btn primary">
        Extract Games
      </button>

      <span id="scheduleParseStatus" class="parse-status">
        No schedule parsed
      </span>

    </div>


    <!-- ===============================
         Parser Sample Preview
         (Step 6)
    ================================ -->
    <div id="parserSample" class="parser-sample" hidden>

      <h4>Parsed Output (raw)</h4>
      <pre id="parsedPreview"></pre>

      <h4>Normalized Output (final schema)</h4>
      <pre id="normalizedPreview"></pre>

    </div>

  </div>
</section>


	<!-- ============================================================ -->
	<!-- 2. Load or Save Schedules -->
	<!-- ============================================================ -->
	<section class="collapsible-panel" id="section-schedule">
	  <button type="button" class="collapsible-header">
		<span class="collapsible-icon">+</span>
		<span class="collapsible-title">2. Load or Save Schedules</span>
	  </button>

	  <p class="section-subtitle">Manage saved schedule sets below.</p>

	  <div class="collapsible-body">

		<label for="currentScheduleDisplay">Current Schedule:</label>
		<textarea
		  id="currentScheduleDisplay"
		  readonly
		  placeholder="Parsed games will appear here‚Ä¶"
		  style="width:66%; height:300px; font-family:monospace; font-size:14px;">
		</textarea>

		<div class="schedule-controls">
		  <label for="scheduleSelect">Saved Schedules:</label>
		  <select id="scheduleSelect"></select>

		  <button id="loadScheduleBtn" class="btn">Load</button>
		  <button id="deleteScheduleBtn" class="btn secondary">Delete</button>
		  <button id="saveScheduleBtnLibrary" class="btn primary">
			üíæ Save Schedule
		  </button>
		</div>
	  </div>
	</section>


	<!-- ============================================================ -->
	<!-- 3. Select & Filter Games -->
	<!-- ============================================================ -->
	<section class="collapsible-panel" id="section-filter">
	  <button type="button" class="collapsible-header">
		<span class="collapsible-icon">+</span>
		<span class="collapsible-title">3. Select & Filter Games</span>
	  </button>

	  <p class="section-subtitle">
		Build rules to select or deselect games.
	  </p>

	  <div class="collapsible-body">
		<div
		  id="filterRulesContainer"
		  class="filter-rules-container">
		</div>

		<div class="filter-controls">
		  <button id="applyFilterBtn" class="btn">Apply Filter</button>
		  <button id="clearFilterBtn" class="btn secondary">Clear</button>

		  <button id="selectMatchingBtn" class="btn">
			‚úî Select Matching
		  </button>
		  <button id="deselectMatchingBtn" class="btn secondary">
			‚úñ Deselect Matching
		  </button>
		</div>
	  </div>
	</section>


<!-- ============================================================ -->
<!-- 4. Bulk Edit Selected Cards -->
<!-- ============================================================ -->
<section class="collapsible-panel" id="section-bulk-edit">
  <button type="button" class="collapsible-header">
    <span class="collapsible-icon">+</span>
    <span class="collapsible-title">
      4. Bulk Edit Selected Cards
    </span>
  </button>

	<p class="section-subtitle" id="bulkEditStatus"></p>

  <div class="collapsible-body">
    <div class="macos-bulk-panel">

      <div class="macos-row two-columns">
        <div class="column">
          <label for="bulkDate">Date</label>
          <input id="bulkDate" type="date" class="macos-input">
        </div>
        <div class="column">
          <label for="bulkDivision">Division</label>
          <input id="bulkDivision" type="text" class="macos-input">
        </div>
      </div>

      <div class="macos-row two-columns">
        <div class="column">
          <label for="bulkLocation">Location</label>
          <input id="bulkLocation" type="text" class="macos-input">
        </div>
        <div class="column">
          <label for="bulkField">Field</label>
          <input id="bulkField" type="text" class="macos-input">
        </div>
      </div>

      <div class="macos-row">
        <label>Assigner Info</label>
        <input id="bulkAssignName" class="macos-input" type="text" placeholder="Name">
        <input id="bulkAssignPhone" class="macos-input" type="text" placeholder="Phone">
        <input id="bulkAssignEmail" class="macos-input" type="text" placeholder="Email">
      </div>

      <div class="macos-row">
        <label>Payer Info</label>
        <input id="bulkPayerName" class="macos-input" type="text" placeholder="Name">
        <input id="bulkPayerPhone" class="macos-input" type="text" placeholder="Phone">
        <input id="bulkPayerEmail" class="macos-input" type="text" placeholder="Email">
      </div>

      <div class="macos-button-row">
        <button id="applyBulkEditBtn" class="btn">
          Apply to Selected Games
        </button>
        <button id="clearBulkEditBtn" class="btn secondary">
          Clear Bulk Edit Fields
        </button>
      </div>

    </div>
  </div>
</section>


<!-- ============================================================ -->
<!-- 5. Game Card Preview -->
<!-- ============================================================ -->
<section class="collapsible-panel" id="section-preview">
  <button type="button" class="collapsible-header">
    <span class="collapsible-icon">+</span>
    <span class="collapsible-title">5. Game Card Preview</span>
  </button>

  <div id="previewStatus" class="section-status"></div>

  <div class="collapsible-body">
    <div id="cardsContainer" class="cards-container"></div>
  </div>
</section>


<!-- ============================================================ -->
<!-- 6. Choose Report Card Template -->
<!-- ============================================================ -->
<section class="collapsible-panel" id="section-template">
  <button type="button" class="collapsible-header">
    <span class="collapsible-icon">+</span>
    <span class="collapsible-title">
      6. Choose Report Card Template
    </span>
  </button>

  <div id="templateStatus" class="section-status"></div>

  <div class="collapsible-body">
    <div id="templateCarousel">
      <button id="prevTemplate">‚Äπ</button>
      <img id="templateImage" alt="Template preview" style="max-width:200px;">
      <button id="nextTemplate">‚Ä∫</button>

      <div id="templateName"></div>
    </div>
  </div>
</section>


<!-- ============================================================ -->
<!-- 7. Generate PDF Game Cards -->
<!-- ============================================================ -->
<section class="collapsible-panel" id="section-generate">
  <button type="button" class="collapsible-header">
    <span class="collapsible-icon">+</span>
    <span class="collapsible-title">
      7. Generate PDF Game Cards
    </span>
  </button>

  <div id="generateStatus" class="section-status"></div>

  <div class="collapsible-body">
    <!-- PDF generation UI goes here -->
  </div>
</section>
</div>
<!-- /.container -->

<!-- ========================= -->
<!-- Shared Edit Modal -->
<!-- ========================= -->
<div id="sharedEditModal" class="modal-backdrop hidden">
  <div class="modal-content">
    <h3>Edit Game</h3>

    <!-- Show/Hide Empty Fields Toggle -->
    <div class="modal-toggle-row" style="text-align:right; margin-bottom: 1em;">
      <button id="toggleHiddenFieldsBtn" class="btn small">Show Empty Fields</button>
    </div>

    <!-- Modal Body Content Injected Here -->
    <div id="sharedEditModalBody"></div>

    <!-- Modal Action Buttons -->
    <div class="modal-buttons">
      <button id="sharedSaveEditBtn" class="btn">Save</button>
      <button id="sharedCancelEditBtn" class="btn secondary">Cancel</button>
    </div>
  </div>
</div>

<!-- ========================= -->
<!-- Save Schedule Modal -->
<!-- ========================= -->
<div id="scheduleSaveModal" class="modal hidden">
  <div class="modal-content">
    <h2>Save Schedule</h2>

    <label for="scheduleNameInput">Enter a name for this schedule:</label>
    <input type="text" id="scheduleNameInput" />

    <div id="scheduleSaveError" class="error hidden"></div>

    <div class="modal-actions">
      <button id="saveScheduleConfirmBtn" class="btn primary">Save</button>
      <button id="saveScheduleCancelBtn" class="btn secondary">Cancel</button>
    </div>
  </div>
</div>
<!-- ========================= -->
<footer>
  <p>¬© 2025 Law Five Referee</p>
</footer>

<script type="module" src="js/module-loader.js"></script>
<script async src="//gc.zgo.at/count.js" data-goatcounter="https://law5ref.goatcounter.com/count"></script>

</body>
</html>
